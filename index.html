<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kennametal • Kühlmittel-Durchfluss Rechner</title>
  <meta name="theme-color" content="#FFD100">
  <style>
    :root{
      --km-yellow:#FFD100;
      --bg:#0a0a0a;
      --card:#121212;
      --muted:#9ca3af;
      --text:#f5f5f5;
      --accent:var(--km-yellow);
      --good:#22c55e;
      --warn:#f59e0b;
    }
    *{box-sizing:border-box}
    body{margin:0;background:radial-gradient(1200px 600px at 20% -10%,#1a1a1a,transparent),linear-gradient(180deg,#0a0a0a,#0f0f0f 35%,#0a0a0a);color:var(--text);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu}
    .wrap{max-width:980px;margin:40px auto;padding:24px}

    /* Brandbar */
    .brandbar{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border:1px solid rgba(255,255,255,.06);background:#0d0d0d;border-radius:14px;margin-bottom:16px}
    .brand-left{display:flex;align-items:center;gap:12px}
    .logo-box{width:40px;height:40px;border-radius:10px;background:var(--km-yellow);display:grid;place-items:center}
    .logo-box span{font-weight:900;color:#000;letter-spacing:.5px}
    .brand-title{font-weight:700}
    .brand-right{display:flex;align-items:center;gap:10px}
    .brand-right input[type=file]{display:none}
    .brand-right button, .brand-right label{cursor:pointer;border:1px solid rgba(255,255,255,.12);background:transparent;color:var(--text);padding:8px 12px;border-radius:10px;font-size:14px}
    .brand-right label:hover{border-color:var(--km-yellow)}
    .brand-logo{height:28px;display:none}

    h1{font-size:clamp(22px,3.2vw,34px);line-height:1.1;margin:0 0 8px 0}
    p.sub{color:var(--muted);margin:0 0 22px 0}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px}
    .card{background:rgba(18,18,18,.85);backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:16px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input, select {width:100%;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.12);background:#0f0f0f;color:var(--text);outline:none}
    input:focus, select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(255,209,0,.25)}
    .row{display:flex;gap:10px;align-items:center}
    .row > * {flex:1}
    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}
    button{cursor:pointer;border:1px solid rgba(255,255,255,.16);background:transparent;color:var(--text);padding:10px 14px;border-radius:12px}
    button.primary{border-color:#000;background:var(--accent);color:#000;font-weight:700}
    button.primary:hover{filter:brightness(0.95)}
    button:active{transform:translateY(1px)}
    .results{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:16px}
    .kpi{border:1px dashed rgba(255,255,255,.18);border-radius:14px;padding:14px;position:relative}
    .kpi h3{margin:0 0 4px 0;font-size:14px;color:var(--muted)}
    .kpi .val{font-variant-numeric: tabular-nums; font-size:22px}
    .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    details{margin-top:10px}
    summary{cursor:pointer;color:var(--accent)}
    .foot{margin-top:24px;font-size:12px;color:var(--muted)}
    .formula{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px; color:#e5e7eb}
    .badge{position:absolute;top:10px;right:10px;background:var(--km-yellow);color:#000;padding:2px 6px;border-radius:999px;font-size:10px;font-weight:800}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brandbar">
      <div class="brand-left">
        <div class="logo-box"><span>K</span></div>
        <div class="brand-title">Kennametal • Kühlmittel-Durchfluss Rechner</div>
        <img id="brandLogo" class="brand-logo" alt="Kennametal Logo" />
      </div>
      <div class="brand-right">
        <label for="logoUpload">Logo hochladen</label>
        <input id="logoUpload" type="file" accept="image/*,image/svg+xml" />
      </div>
    </div>

    <h1>Kühlmittel-Durchfluss Rechner</h1>
    <p class="sub">Berechnet den Volumenstrom durch <strong>n</strong> Austritte (Düsen) nach der Orifice-Gleichung. Eingaben in <em>mm</em> und <em>bar</em>. Ausgabe in <strong>L/min</strong>.</p>

    <div class="grid">
      <div class="card">
        <label for="d">Durchmesser pro Austritt (mm)</label>
        <input id="d" type="number" step="0.01" min="0" value="1.60" />
        <div class="hint">Beispiel: 1,60</div>
      </div>
      <div class="card">
        <label for="n">Anzahl der Austritte (Stück)</label>
        <input id="n" type="number" step="1" min="1" value="20" />
        <div class="hint">Z. B. 10 oder 20</div>
      </div>
      <div class="card">
        <label for="p">Druck Δp am Werkzeug (bar)</label>
        <input id="p" type="number" step="0.1" min="0" value="30" />
        <div class="hint">Wirkt am Austritt (nach Leitungsverlusten)</div>
      </div>
      <div class="card">
        <label for="fluid">Medium</label>
        <select id="fluid">
          <option value="998">Wasser / Emulsion (ρ≈998 kg/m³)</option>
          <option value="1000">KSS pauschal (ρ=1000 kg/m³)</option>
          <option value="850">Öl dünn (ρ≈850 kg/m³)</option>
          <option value="custom">Eigenen Dichtewert…</option>
        </select>
        <div class="row" id="rhoRow" style="display:none;margin-top:8px">
          <input id="rho" type="number" step="1" min="100" value="1000" />
          <span class="hint">kg/m³</span>
        </div>
      </div>
      <div class="card">
        <label for="cd">Ausflussbeiwert C<sub>d</sub></label>
        <input id="cd" type="number" step="0.01" min="0.40" max="1.00" value="0.80" />
        <div class="hint">Typisch 0,7–0,9 (Kanten, Fase, Scharf-/Rundkante)</div>
      </div>
    </div>

    <div class="btns">
      <button class="primary" id="calc">Berechnen</button>
      <button id="presetA">Preset: Ø1,6 | 20 Löcher | 30 bar</button>
      <button id="presetB">Preset: Ø1,6 | 10 Löcher | 30 bar</button>
      <button id="reset">Zurücksetzen</button>
    </div>

    <div class="results" id="results" aria-live="polite"></div>

    <details>
      <summary>Formeln & Hinweise</summary>
      <div class="card" style="margin-top:10px">
        <p class="formula">A<sub>loch</sub> = π·(d/2)<sup>2</sup> · 10<sup>−6</sup>  [m²] (d in mm)
          <br/>A<sub>ges</sub> = n · A<sub>loch</sub>
          <br/>Δp = bar · 10<sup>5</sup>  [Pa]
          <br/>v = √(2·Δp / ρ)  [m/s]
          <br/>Q = C<sub>d</sub> · A<sub>ges</sub> · v  [m³/s]
          <br/>Q<sub>L/min</sub> = Q · 60 · 1000  [L/min]
          <br/>P<sub>hydr</sub> = Δp · Q  [W]
        </p>
        <p class="hint">Die Ergebnisse gelten für den Druck <em>am Werkzeug</em>. Leitungs-/Spindelverluste und die Pumpenkennlinie reduzieren den Durchsatz.</p>
      </div>
    </details>

    <p class="foot">© 2025 • Rechenhilfe ohne Gewähr. Tippeingaben aktualisieren das Ergebnis auch ohne Button.</p>
  </div>

  <script>
    const el = id => document.getElementById(id);
    const d = el('d');
    const n = el('n');
    const p = el('p');
    const fluid = el('fluid');
    const rhoInput = el('rho');
    const rhoRow = el('rhoRow');
    const cd = el('cd');
    const res = el('results');

    // Brand / Logo upload
    const logoUpload = el('logoUpload');
    const brandLogo = el('brandLogo');
    if(logoUpload){
      logoUpload.addEventListener('change', ()=>{
        const f = (logoUpload.files && logoUpload.files[0]) || null;
        if(!f) return;
        const url = URL.createObjectURL(f);
        brandLogo.src = url;
        brandLogo.style.display = 'block';
      });
    }

    function currentRho(){
      if(fluid.value === 'custom') return Number(rhoInput.value)||1000;
      return Number(fluid.value);
    }

    function fmt(x, digits=2){
      return Number.isFinite(x)? x.toLocaleString('de-DE',{maximumFractionDigits:digits, minimumFractionDigits:digits}) : '—';
    }

    function compute(){
      const d_mm = Math.max(0, Number(d.value));
      const n_holes = Math.max(0, Math.floor(Number(n.value)));
      const bar = Math.max(0, Number(p.value));
      const rho = currentRho();
      const C_d = Math.min(1, Math.max(0, Number(cd.value)));

      const area_one_m2 = Math.PI * Math.pow(d_mm/2,2) * 1e-6; // mm^2 -> m^2
      const area_total_m2 = area_one_m2 * n_holes;
      const dp_Pa = bar * 1e5; // bar -> Pa
      const v = Math.sqrt(2*dp_Pa/ rho );
      const Q_m3s_ideal = area_total_m2 * v;
      const Q_m3s = C_d * Q_m3s_ideal;
      const Q_Lmin = Q_m3s * 60 * 1000;
      const Q_Lmin_per = n_holes>0 ? Q_Lmin / n_holes : 0;
      const P_w = dp_Pa * Q_m3s; // hydraulic power
      const d_eq_mm = Math.sqrt(4*area_total_m2/Math.PI) * 1e3; // m -> mm

      res.innerHTML = `
        <div class="kpi"><h3>Gesamtfläche A<sub>ges</sub></h3><div class="val mono">${fmt(area_total_m2*1e6,2)} mm²  <span class="hint">(${fmt(area_total_m2,6)} m²)</span></div><div class="badge">A</div></div>
        <div class="kpi"><h3>Äquiv. Ø (ein Loch)</h3><div class="val mono">${fmt(d_eq_mm,2)} mm</div><div class="badge">Ø</div></div>
        <div class="kpi"><h3>Volumenstrom gesamt</h3><div class="val mono">${fmt(Q_Lmin,1)} L/min</div><div class="badge">Q</div></div>
        <div class="kpi"><h3>Volumenstrom je Austritt</h3><div class="val mono">${fmt(Q_Lmin_per,2)} L/min</div><div class="badge">Q/n</div></div>
        <div class="kpi"><h3>Strahlaustrittsgeschw.</h3><div class="val mono">${fmt(v,1)} m/s</div><div class="badge">v</div></div>
        <div class="kpi"><h3>Hydraulische Leistung</h3><div class="val mono">${fmt(P_w/1000,2)} kW</div><div class="badge">P</div></div>
      `;
    }

    // UI wiring
    el('calc').addEventListener('click', compute);
    [d,n,p,cd, rhoInput].forEach(x=> x.addEventListener('input', compute));
    fluid.addEventListener('change', ()=>{
      rhoRow.style.display = fluid.value==='custom' ? 'flex' : 'none';
      compute();
    });

    el('presetA').addEventListener('click', ()=>{ d.value=1.6; n.value=20; p.value=30; cd.value=0.80; fluid.value='1000'; rhoRow.style.display='none'; compute(); });
    el('presetB').addEventListener('click', ()=>{ d.value=1.6; n.value=10; p.value=30; cd.value=0.80; fluid.value='1000'; rhoRow.style.display='none'; compute(); });
    el('reset').addEventListener('click', ()=>{ d.value=1.60; n.value=20; p.value=30; cd.value=0.80; fluid.value='998'; rhoRow.style.display='none'; rhoInput.value=1000; compute(); });

    // initial
    compute();
  </script>
</body>
</html>
